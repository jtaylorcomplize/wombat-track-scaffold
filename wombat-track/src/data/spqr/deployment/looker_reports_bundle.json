[
  {
    "name": "Active Matters Overview",
    "dataSource": {
      "name": "Active Matters Overview Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          m.matter_number as matter_id,\n          m.matter_name,\n          p.display_name as client_name,\n          m.matter_status,\n          m.date_opened,\n          rp.display_name as responsible_partner,\n          t.due_date as deadline_date,\n          t.task_type as deadline_type,\n          ap.display_name as assigned_fee_earner,\n          t.priority as priority_level,\n          doc.document_count,\n          doc.reviewed_count,\n          dp.production_status,\n          ca.appearance_date as court_date,\n          ca.court_name,\n          ca.hearing_type,\n          ca.attending_participant as attending_counsel,\n          cc.conflict_status,\n          cc.check_date,\n          cc.checked_by_participant as checked_by,\n          m.practice_area\n        FROM matters m\n        LEFT JOIN participants p ON m.client_id = p.participant_id\n        LEFT JOIN participants rp ON m.responsible_partner_id = rp.participant_id\n        LEFT JOIN tasks t ON m.matter_id = t.matter_id\n        LEFT JOIN participants ap ON t.assigned_participant_id = ap.participant_id\n        LEFT JOIN (\n          SELECT matter_id, COUNT(*) as document_count, \n                 SUM(CASE WHEN review_status = 'reviewed' THEN 1 ELSE 0 END) as reviewed_count\n          FROM documents \n          GROUP BY matter_id\n        ) doc ON m.matter_id = doc.matter_id\n        LEFT JOIN document_productions dp ON m.matter_id = dp.matter_id\n        LEFT JOIN court_appearances ca ON m.matter_id = ca.matter_id\n        LEFT JOIN conflict_checks cc ON m.matter_id = cc.matter_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "matter_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "matter_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "client_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "matter_status",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "date_opened",
        "type": "DATE",
        "aggregation": "NONE"
      },
      {
        "name": "responsible_partner",
        "type": "TEXT",
        "aggregation": "NONE"
      }
    ],
    "filters": [
      {
        "field": "matter_status",
        "type": "DROPDOWN",
        "defaultValue": "Active",
        "allowMultiple": true,
        "options": [
          "\"Active"
        ]
      }
    ],
    "visualization": {
      "type": "TABLE",
      "config": {
        "dimensions": [
          "matter_id",
          "matter_name",
          "client_name",
          "matter_status",
          "date_opened",
          "responsible_partner"
        ],
        "metrics": [],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "partner",
        "senior_associate"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Billing Rate Analysis",
    "dataSource": {
      "name": "Billing Rate Analysis Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          SUM(CASE WHEN i.payment_status = 'paid' THEN i.total_amount ELSE 0 END) as total_revenue,\n          'current_month' as billing_period,\n          COUNT(DISTINCT m.matter_id) as matter_count,\n          SUM(CASE WHEN i.payment_status != 'paid' THEN i.total_amount ELSE 0 END) as outstanding_balance,\n          i.invoice_id,\n          i.invoice_amount,\n          i.invoice_date,\n          i.payment_status,\n          DATEDIFF(CURRENT_DATE, i.invoice_date) as days_outstanding,\n          m.matter_id,\n          m.matter_name,\n          SUM(te.billable_amount) as total_fees,\n          SUM(d.cost_amount) as total_costs,\n          ((SUM(te.billable_amount) - SUM(d.cost_amount)) / SUM(te.billable_amount) * 100) as profit_margin,\n          ta.trust_account_id,\n          ta.current_balance as account_balance,\n          ta.last_reconciliation_date as last_reconciled,\n          ta.reconciliation_status,\n          wip.wip_amount,\n          wip.aging_bucket,\n          mb.budgeted_amount,\n          (SUM(te.billable_amount) + SUM(d.amount)) as actual_amount,\n          (((SUM(te.billable_amount) + SUM(d.amount)) - mb.budgeted_amount) / mb.budgeted_amount * 100) as variance_percentage,\n          CASE \n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) > mb.budgeted_amount THEN 'Over Budget'\n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) < mb.budgeted_amount * 0.9 THEN 'Under Budget'\n            ELSE 'On Budget'\n          END as budget_status,\n          d.disbursement_id,\n          d.disbursement_amount,\n          d.disbursement_type,\n          d.reimbursement_status,\n          pa.practice_area,\n          SUM(pa_rev.revenue_amount) as revenue_amount,\n          AVG(pa_rev.avg_matter_value) as avg_matter_value,\n          pa_rev.growth_rate\n        FROM participants c\n        LEFT JOIN matters m ON c.participant_id = m.client_id\n        LEFT JOIN invoices i ON m.matter_id = i.matter_id\n        LEFT JOIN time_entries te ON m.matter_id = te.matter_id\n        LEFT JOIN disbursements d ON m.matter_id = d.matter_id\n        LEFT JOIN trust_accounts ta ON c.participant_id = ta.client_id\n        LEFT JOIN matter_budgets mb ON m.matter_id = mb.matter_id\n        LEFT JOIN (\n          SELECT matter_id, SUM(billable_amount) as wip_amount,\n                 CASE \n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 30 THEN '0-30 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 60 THEN '31-60 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 90 THEN '61-90 days'\n                   ELSE '90+ days'\n                 END as aging_bucket\n          FROM time_entries \n          WHERE invoice_id IS NULL\n          GROUP BY matter_id\n        ) wip ON m.matter_id = wip.matter_id\n        LEFT JOIN practice_areas pa ON m.practice_area_id = pa.practice_area_id\n        LEFT JOIN practice_area_revenue pa_rev ON pa.practice_area_id = pa_rev.practice_area_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, i.invoice_id, d.disbursement_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "fee_earner_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "fee_earner_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "practice_area",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "seniority_level",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "standard_rate",
        "type": "NUMBER",
        "aggregation": "SUM"
      },
      {
        "name": "effective_rate",
        "type": "NUMBER",
        "aggregation": "SUM"
      }
    ],
    "filters": [
      {
        "field": "practice_area",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Litigation"
        ]
      },
      {
        "field": "seniority_level",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Partner"
        ]
      }
    ],
    "visualization": {
      "type": "TABLE",
      "config": {
        "dimensions": [
          "fee_earner_id",
          "fee_earner_name",
          "practice_area",
          "seniority_level"
        ],
        "metrics": [
          "standard_rate",
          "effective_rate"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "partner",
        "senior_associate"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Client Communication Log",
    "dataSource": {
      "name": "Client Communication Log Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          AVG(cs.satisfaction_rating) as satisfaction_score,\n          cs.survey_date,\n          cs.feedback_category,\n          comm.communication_date,\n          comm.communication_type,\n          AVG(DATEDIFF(comm.response_date, comm.inquiry_date) * 24) as response_time_hours,\n          p.display_name as fee_earner_name,\n          tasks.tasks_completed,\n          tasks.tasks_pending,\n          (tasks.tasks_completed / (tasks.tasks_completed + tasks.tasks_pending) * 100) as completion_rate,\n          AVG(DATEDIFF(tasks.completion_date, tasks.assignment_date)) as avg_completion_time\n        FROM participants c\n        LEFT JOIN client_surveys cs ON c.participant_id = cs.client_id\n        LEFT JOIN communications comm ON c.participant_id = comm.client_id\n        LEFT JOIN participants p ON comm.fee_earner_id = p.participant_id\n        LEFT JOIN (\n          SELECT \n            fee_earner_id,\n            SUM(CASE WHEN status = 'completed' THEN 1 ELSE 0 END) as tasks_completed,\n            SUM(CASE WHEN status IN ('pending', 'in_progress') THEN 1 ELSE 0 END) as tasks_pending,\n            completion_date,\n            assignment_date\n          FROM tasks\n          GROUP BY fee_earner_id\n        ) tasks ON p.participant_id = tasks.fee_earner_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, cs.survey_date, comm.communication_date\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "client_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "communication_date",
        "type": "DATE",
        "aggregation": "NONE"
      },
      {
        "name": "communication_type",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "fee_earner_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "response_time_hours",
        "type": "NUMBER",
        "aggregation": "COUNT"
      }
    ],
    "filters": [
      {
        "field": "communication_type",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Email"
        ]
      }
    ],
    "visualization": {
      "type": "TABLE",
      "config": {
        "dimensions": [
          "client_id",
          "communication_date",
          "communication_type",
          "fee_earner_name"
        ],
        "metrics": [
          "response_time_hours"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "all_users"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Client Revenue Summary",
    "dataSource": {
      "name": "Client Revenue Summary Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          SUM(CASE WHEN i.payment_status = 'paid' THEN i.total_amount ELSE 0 END) as total_revenue,\n          'current_month' as billing_period,\n          COUNT(DISTINCT m.matter_id) as matter_count,\n          SUM(CASE WHEN i.payment_status != 'paid' THEN i.total_amount ELSE 0 END) as outstanding_balance,\n          i.invoice_id,\n          i.invoice_amount,\n          i.invoice_date,\n          i.payment_status,\n          DATEDIFF(CURRENT_DATE, i.invoice_date) as days_outstanding,\n          m.matter_id,\n          m.matter_name,\n          SUM(te.billable_amount) as total_fees,\n          SUM(d.cost_amount) as total_costs,\n          ((SUM(te.billable_amount) - SUM(d.cost_amount)) / SUM(te.billable_amount) * 100) as profit_margin,\n          ta.trust_account_id,\n          ta.current_balance as account_balance,\n          ta.last_reconciliation_date as last_reconciled,\n          ta.reconciliation_status,\n          wip.wip_amount,\n          wip.aging_bucket,\n          mb.budgeted_amount,\n          (SUM(te.billable_amount) + SUM(d.amount)) as actual_amount,\n          (((SUM(te.billable_amount) + SUM(d.amount)) - mb.budgeted_amount) / mb.budgeted_amount * 100) as variance_percentage,\n          CASE \n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) > mb.budgeted_amount THEN 'Over Budget'\n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) < mb.budgeted_amount * 0.9 THEN 'Under Budget'\n            ELSE 'On Budget'\n          END as budget_status,\n          d.disbursement_id,\n          d.disbursement_amount,\n          d.disbursement_type,\n          d.reimbursement_status,\n          pa.practice_area,\n          SUM(pa_rev.revenue_amount) as revenue_amount,\n          AVG(pa_rev.avg_matter_value) as avg_matter_value,\n          pa_rev.growth_rate\n        FROM participants c\n        LEFT JOIN matters m ON c.participant_id = m.client_id\n        LEFT JOIN invoices i ON m.matter_id = i.matter_id\n        LEFT JOIN time_entries te ON m.matter_id = te.matter_id\n        LEFT JOIN disbursements d ON m.matter_id = d.matter_id\n        LEFT JOIN trust_accounts ta ON c.participant_id = ta.client_id\n        LEFT JOIN matter_budgets mb ON m.matter_id = mb.matter_id\n        LEFT JOIN (\n          SELECT matter_id, SUM(billable_amount) as wip_amount,\n                 CASE \n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 30 THEN '0-30 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 60 THEN '31-60 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 90 THEN '61-90 days'\n                   ELSE '90+ days'\n                 END as aging_bucket\n          FROM time_entries \n          WHERE invoice_id IS NULL\n          GROUP BY matter_id\n        ) wip ON m.matter_id = wip.matter_id\n        LEFT JOIN practice_areas pa ON m.practice_area_id = pa.practice_area_id\n        LEFT JOIN practice_area_revenue pa_rev ON pa.practice_area_id = pa_rev.practice_area_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, i.invoice_id, d.disbursement_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "client_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "client_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "billing_period",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "total_revenue",
        "type": "NUMBER",
        "aggregation": "SUM"
      },
      {
        "name": "matter_count",
        "type": "NUMBER",
        "aggregation": "COUNT"
      },
      {
        "name": "outstanding_balance",
        "type": "NUMBER",
        "aggregation": "SUM"
      }
    ],
    "filters": [
      {
        "field": "billing_period",
        "type": "DROPDOWN",
        "defaultValue": "current_month",
        "allowMultiple": true,
        "options": [
          "\"current_month"
        ]
      }
    ],
    "visualization": {
      "type": "BAR_CHART",
      "config": {
        "dimensions": [
          "client_id",
          "client_name",
          "billing_period"
        ],
        "metrics": [
          "total_revenue",
          "matter_count",
          "outstanding_balance"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "partner",
        "senior_associate"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Client Satisfaction Metrics",
    "dataSource": {
      "name": "Client Satisfaction Metrics Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          AVG(cs.satisfaction_rating) as satisfaction_score,\n          cs.survey_date,\n          cs.feedback_category,\n          comm.communication_date,\n          comm.communication_type,\n          AVG(DATEDIFF(comm.response_date, comm.inquiry_date) * 24) as response_time_hours,\n          p.display_name as fee_earner_name,\n          tasks.tasks_completed,\n          tasks.tasks_pending,\n          (tasks.tasks_completed / (tasks.tasks_completed + tasks.tasks_pending) * 100) as completion_rate,\n          AVG(DATEDIFF(tasks.completion_date, tasks.assignment_date)) as avg_completion_time\n        FROM participants c\n        LEFT JOIN client_surveys cs ON c.participant_id = cs.client_id\n        LEFT JOIN communications comm ON c.participant_id = comm.client_id\n        LEFT JOIN participants p ON comm.fee_earner_id = p.participant_id\n        LEFT JOIN (\n          SELECT \n            fee_earner_id,\n            SUM(CASE WHEN status = 'completed' THEN 1 ELSE 0 END) as tasks_completed,\n            SUM(CASE WHEN status IN ('pending', 'in_progress') THEN 1 ELSE 0 END) as tasks_pending,\n            completion_date,\n            assignment_date\n          FROM tasks\n          GROUP BY fee_earner_id\n        ) tasks ON p.participant_id = tasks.fee_earner_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, cs.survey_date, comm.communication_date\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "client_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "client_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "survey_date",
        "type": "DATE",
        "aggregation": "NONE"
      },
      {
        "name": "feedback_category",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "satisfaction_score",
        "type": "NUMBER",
        "aggregation": "AVG"
      }
    ],
    "filters": [
      {
        "field": "feedback_category",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Service Quality"
        ]
      }
    ],
    "visualization": {
      "type": "LINE_CHART",
      "config": {
        "dimensions": [
          "client_id",
          "client_name",
          "survey_date",
          "feedback_category"
        ],
        "metrics": [
          "satisfaction_score"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "partner",
        "senior_associate"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Conflict Check Dashboard",
    "dataSource": {
      "name": "Conflict Check Dashboard Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          m.matter_number as matter_id,\n          m.matter_name,\n          p.display_name as client_name,\n          m.matter_status,\n          m.date_opened,\n          rp.display_name as responsible_partner,\n          t.due_date as deadline_date,\n          t.task_type as deadline_type,\n          ap.display_name as assigned_fee_earner,\n          t.priority as priority_level,\n          doc.document_count,\n          doc.reviewed_count,\n          dp.production_status,\n          ca.appearance_date as court_date,\n          ca.court_name,\n          ca.hearing_type,\n          ca.attending_participant as attending_counsel,\n          cc.conflict_status,\n          cc.check_date,\n          cc.checked_by_participant as checked_by,\n          m.practice_area\n        FROM matters m\n        LEFT JOIN participants p ON m.client_id = p.participant_id\n        LEFT JOIN participants rp ON m.responsible_partner_id = rp.participant_id\n        LEFT JOIN tasks t ON m.matter_id = t.matter_id\n        LEFT JOIN participants ap ON t.assigned_participant_id = ap.participant_id\n        LEFT JOIN (\n          SELECT matter_id, COUNT(*) as document_count, \n                 SUM(CASE WHEN review_status = 'reviewed' THEN 1 ELSE 0 END) as reviewed_count\n          FROM documents \n          GROUP BY matter_id\n        ) doc ON m.matter_id = doc.matter_id\n        LEFT JOIN document_productions dp ON m.matter_id = dp.matter_id\n        LEFT JOIN court_appearances ca ON m.matter_id = ca.matter_id\n        LEFT JOIN conflict_checks cc ON m.matter_id = cc.matter_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "matter_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "client_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "conflict_status",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "check_date",
        "type": "DATE",
        "aggregation": "NONE"
      },
      {
        "name": "checked_by",
        "type": "TEXT",
        "aggregation": "NONE"
      }
    ],
    "filters": [
      {
        "field": "conflict_status",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Clear"
        ]
      }
    ],
    "visualization": {
      "type": "TABLE",
      "config": {
        "dimensions": [
          "matter_id",
          "client_name",
          "conflict_status",
          "check_date",
          "checked_by"
        ],
        "metrics": [],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "all_users"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Court Appearance Calendar",
    "dataSource": {
      "name": "Court Appearance Calendar Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          m.matter_number as matter_id,\n          m.matter_name,\n          p.display_name as client_name,\n          m.matter_status,\n          m.date_opened,\n          rp.display_name as responsible_partner,\n          t.due_date as deadline_date,\n          t.task_type as deadline_type,\n          ap.display_name as assigned_fee_earner,\n          t.priority as priority_level,\n          doc.document_count,\n          doc.reviewed_count,\n          dp.production_status,\n          ca.appearance_date as court_date,\n          ca.court_name,\n          ca.hearing_type,\n          ca.attending_participant as attending_counsel,\n          cc.conflict_status,\n          cc.check_date,\n          cc.checked_by_participant as checked_by,\n          m.practice_area\n        FROM matters m\n        LEFT JOIN participants p ON m.client_id = p.participant_id\n        LEFT JOIN participants rp ON m.responsible_partner_id = rp.participant_id\n        LEFT JOIN tasks t ON m.matter_id = t.matter_id\n        LEFT JOIN participants ap ON t.assigned_participant_id = ap.participant_id\n        LEFT JOIN (\n          SELECT matter_id, COUNT(*) as document_count, \n                 SUM(CASE WHEN review_status = 'reviewed' THEN 1 ELSE 0 END) as reviewed_count\n          FROM documents \n          GROUP BY matter_id\n        ) doc ON m.matter_id = doc.matter_id\n        LEFT JOIN document_productions dp ON m.matter_id = dp.matter_id\n        LEFT JOIN court_appearances ca ON m.matter_id = ca.matter_id\n        LEFT JOIN conflict_checks cc ON m.matter_id = cc.matter_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "matter_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "court_date",
        "type": "DATE",
        "aggregation": "NONE"
      },
      {
        "name": "court_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "hearing_type",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "attending_counsel",
        "type": "TEXT",
        "aggregation": "NONE"
      }
    ],
    "filters": [
      {
        "field": "court_date",
        "type": "DATE_RANGE",
        "defaultValue": "next_30_days",
        "allowMultiple": false,
        "options": [
          "\"today"
        ]
      },
      {
        "field": "hearing_type",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Directions"
        ]
      }
    ],
    "visualization": {
      "type": "TABLE",
      "config": {
        "dimensions": [
          "matter_id",
          "court_date",
          "court_name",
          "hearing_type",
          "attending_counsel"
        ],
        "metrics": [],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "all_users"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Deadline Tracker",
    "dataSource": {
      "name": "Deadline Tracker Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          m.matter_number as matter_id,\n          m.matter_name,\n          p.display_name as client_name,\n          m.matter_status,\n          m.date_opened,\n          rp.display_name as responsible_partner,\n          t.due_date as deadline_date,\n          t.task_type as deadline_type,\n          ap.display_name as assigned_fee_earner,\n          t.priority as priority_level,\n          doc.document_count,\n          doc.reviewed_count,\n          dp.production_status,\n          ca.appearance_date as court_date,\n          ca.court_name,\n          ca.hearing_type,\n          ca.attending_participant as attending_counsel,\n          cc.conflict_status,\n          cc.check_date,\n          cc.checked_by_participant as checked_by,\n          m.practice_area\n        FROM matters m\n        LEFT JOIN participants p ON m.client_id = p.participant_id\n        LEFT JOIN participants rp ON m.responsible_partner_id = rp.participant_id\n        LEFT JOIN tasks t ON m.matter_id = t.matter_id\n        LEFT JOIN participants ap ON t.assigned_participant_id = ap.participant_id\n        LEFT JOIN (\n          SELECT matter_id, COUNT(*) as document_count, \n                 SUM(CASE WHEN review_status = 'reviewed' THEN 1 ELSE 0 END) as reviewed_count\n          FROM documents \n          GROUP BY matter_id\n        ) doc ON m.matter_id = doc.matter_id\n        LEFT JOIN document_productions dp ON m.matter_id = dp.matter_id\n        LEFT JOIN court_appearances ca ON m.matter_id = ca.matter_id\n        LEFT JOIN conflict_checks cc ON m.matter_id = cc.matter_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "matter_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "deadline_date",
        "type": "DATE",
        "aggregation": "NONE"
      },
      {
        "name": "deadline_type",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "matter_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "assigned_fee_earner",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "priority_level",
        "type": "TEXT",
        "aggregation": "NONE"
      }
    ],
    "filters": [
      {
        "field": "deadline_date",
        "type": "DATE_RANGE",
        "defaultValue": "next_30_days",
        "allowMultiple": false,
        "options": [
          "\"next_7_days"
        ]
      },
      {
        "field": "deadline_type",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Court Filing"
        ]
      },
      {
        "field": "priority_level",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"High"
        ]
      }
    ],
    "visualization": {
      "type": "BAR_CHART",
      "config": {
        "dimensions": [
          "matter_id",
          "deadline_date",
          "deadline_type",
          "matter_name",
          "assigned_fee_earner",
          "priority_level"
        ],
        "metrics": [],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "all_users"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Disbursement Tracking",
    "dataSource": {
      "name": "Disbursement Tracking Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          SUM(CASE WHEN i.payment_status = 'paid' THEN i.total_amount ELSE 0 END) as total_revenue,\n          'current_month' as billing_period,\n          COUNT(DISTINCT m.matter_id) as matter_count,\n          SUM(CASE WHEN i.payment_status != 'paid' THEN i.total_amount ELSE 0 END) as outstanding_balance,\n          i.invoice_id,\n          i.invoice_amount,\n          i.invoice_date,\n          i.payment_status,\n          DATEDIFF(CURRENT_DATE, i.invoice_date) as days_outstanding,\n          m.matter_id,\n          m.matter_name,\n          SUM(te.billable_amount) as total_fees,\n          SUM(d.cost_amount) as total_costs,\n          ((SUM(te.billable_amount) - SUM(d.cost_amount)) / SUM(te.billable_amount) * 100) as profit_margin,\n          ta.trust_account_id,\n          ta.current_balance as account_balance,\n          ta.last_reconciliation_date as last_reconciled,\n          ta.reconciliation_status,\n          wip.wip_amount,\n          wip.aging_bucket,\n          mb.budgeted_amount,\n          (SUM(te.billable_amount) + SUM(d.amount)) as actual_amount,\n          (((SUM(te.billable_amount) + SUM(d.amount)) - mb.budgeted_amount) / mb.budgeted_amount * 100) as variance_percentage,\n          CASE \n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) > mb.budgeted_amount THEN 'Over Budget'\n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) < mb.budgeted_amount * 0.9 THEN 'Under Budget'\n            ELSE 'On Budget'\n          END as budget_status,\n          d.disbursement_id,\n          d.disbursement_amount,\n          d.disbursement_type,\n          d.reimbursement_status,\n          pa.practice_area,\n          SUM(pa_rev.revenue_amount) as revenue_amount,\n          AVG(pa_rev.avg_matter_value) as avg_matter_value,\n          pa_rev.growth_rate\n        FROM participants c\n        LEFT JOIN matters m ON c.participant_id = m.client_id\n        LEFT JOIN invoices i ON m.matter_id = i.matter_id\n        LEFT JOIN time_entries te ON m.matter_id = te.matter_id\n        LEFT JOIN disbursements d ON m.matter_id = d.matter_id\n        LEFT JOIN trust_accounts ta ON c.participant_id = ta.client_id\n        LEFT JOIN matter_budgets mb ON m.matter_id = mb.matter_id\n        LEFT JOIN (\n          SELECT matter_id, SUM(billable_amount) as wip_amount,\n                 CASE \n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 30 THEN '0-30 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 60 THEN '31-60 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 90 THEN '61-90 days'\n                   ELSE '90+ days'\n                 END as aging_bucket\n          FROM time_entries \n          WHERE invoice_id IS NULL\n          GROUP BY matter_id\n        ) wip ON m.matter_id = wip.matter_id\n        LEFT JOIN practice_areas pa ON m.practice_area_id = pa.practice_area_id\n        LEFT JOIN practice_area_revenue pa_rev ON pa.practice_area_id = pa_rev.practice_area_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, i.invoice_id, d.disbursement_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "disbursement_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "disbursement_type",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "reimbursement_status",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "matter_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "disbursement_amount",
        "type": "NUMBER",
        "aggregation": "SUM"
      }
    ],
    "filters": [
      {
        "field": "disbursement_type",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Court Fees"
        ]
      },
      {
        "field": "reimbursement_status",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Pending"
        ]
      }
    ],
    "visualization": {
      "type": "TABLE",
      "config": {
        "dimensions": [
          "disbursement_id",
          "disbursement_type",
          "reimbursement_status",
          "matter_name"
        ],
        "metrics": [
          "disbursement_amount"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "analyst",
        "admin"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Document Production Status",
    "dataSource": {
      "name": "Document Production Status Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          m.matter_number as matter_id,\n          m.matter_name,\n          p.display_name as client_name,\n          m.matter_status,\n          m.date_opened,\n          rp.display_name as responsible_partner,\n          t.due_date as deadline_date,\n          t.task_type as deadline_type,\n          ap.display_name as assigned_fee_earner,\n          t.priority as priority_level,\n          doc.document_count,\n          doc.reviewed_count,\n          dp.production_status,\n          ca.appearance_date as court_date,\n          ca.court_name,\n          ca.hearing_type,\n          ca.attending_participant as attending_counsel,\n          cc.conflict_status,\n          cc.check_date,\n          cc.checked_by_participant as checked_by,\n          m.practice_area\n        FROM matters m\n        LEFT JOIN participants p ON m.client_id = p.participant_id\n        LEFT JOIN participants rp ON m.responsible_partner_id = rp.participant_id\n        LEFT JOIN tasks t ON m.matter_id = t.matter_id\n        LEFT JOIN participants ap ON t.assigned_participant_id = ap.participant_id\n        LEFT JOIN (\n          SELECT matter_id, COUNT(*) as document_count, \n                 SUM(CASE WHEN review_status = 'reviewed' THEN 1 ELSE 0 END) as reviewed_count\n          FROM documents \n          GROUP BY matter_id\n        ) doc ON m.matter_id = doc.matter_id\n        LEFT JOIN document_productions dp ON m.matter_id = dp.matter_id\n        LEFT JOIN court_appearances ca ON m.matter_id = ca.matter_id\n        LEFT JOIN conflict_checks cc ON m.matter_id = cc.matter_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "matter_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "production_status",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "due_date",
        "type": "DATE",
        "aggregation": "NONE"
      },
      {
        "name": "document_count",
        "type": "NUMBER",
        "aggregation": "COUNT"
      },
      {
        "name": "reviewed_count",
        "type": "NUMBER",
        "aggregation": "COUNT"
      }
    ],
    "filters": [
      {
        "field": "production_status",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Not Started"
        ]
      }
    ],
    "visualization": {
      "type": "BAR_CHART",
      "config": {
        "dimensions": [
          "matter_id",
          "production_status",
          "due_date"
        ],
        "metrics": [
          "document_count",
          "reviewed_count"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "all_users"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Fee Earner Performance",
    "dataSource": {
      "name": "Fee Earner Performance Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          AVG(cs.satisfaction_rating) as satisfaction_score,\n          cs.survey_date,\n          cs.feedback_category,\n          comm.communication_date,\n          comm.communication_type,\n          AVG(DATEDIFF(comm.response_date, comm.inquiry_date) * 24) as response_time_hours,\n          p.display_name as fee_earner_name,\n          tasks.tasks_completed,\n          tasks.tasks_pending,\n          (tasks.tasks_completed / (tasks.tasks_completed + tasks.tasks_pending) * 100) as completion_rate,\n          AVG(DATEDIFF(tasks.completion_date, tasks.assignment_date)) as avg_completion_time\n        FROM participants c\n        LEFT JOIN client_surveys cs ON c.participant_id = cs.client_id\n        LEFT JOIN communications comm ON c.participant_id = comm.client_id\n        LEFT JOIN participants p ON comm.fee_earner_id = p.participant_id\n        LEFT JOIN (\n          SELECT \n            fee_earner_id,\n            SUM(CASE WHEN status = 'completed' THEN 1 ELSE 0 END) as tasks_completed,\n            SUM(CASE WHEN status IN ('pending', 'in_progress') THEN 1 ELSE 0 END) as tasks_pending,\n            completion_date,\n            assignment_date\n          FROM tasks\n          GROUP BY fee_earner_id\n        ) tasks ON p.participant_id = tasks.fee_earner_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, cs.survey_date, comm.communication_date\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "fee_earner_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "fee_earner_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "monthly_billings",
        "type": "NUMBER",
        "aggregation": "SUM"
      },
      {
        "name": "billable_hours",
        "type": "NUMBER",
        "aggregation": "COUNT"
      },
      {
        "name": "realization_rate",
        "type": "NUMBER",
        "aggregation": "AVG"
      },
      {
        "name": "client_origination",
        "type": "NUMBER",
        "aggregation": "COUNT"
      }
    ],
    "filters": [],
    "visualization": {
      "type": "TABLE",
      "config": {
        "dimensions": [
          "fee_earner_id",
          "fee_earner_name"
        ],
        "metrics": [
          "monthly_billings",
          "billable_hours",
          "realization_rate",
          "client_origination"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "partner",
        "senior_associate"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Invoice Status Tracker",
    "dataSource": {
      "name": "Invoice Status Tracker Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          SUM(CASE WHEN i.payment_status = 'paid' THEN i.total_amount ELSE 0 END) as total_revenue,\n          'current_month' as billing_period,\n          COUNT(DISTINCT m.matter_id) as matter_count,\n          SUM(CASE WHEN i.payment_status != 'paid' THEN i.total_amount ELSE 0 END) as outstanding_balance,\n          i.invoice_id,\n          i.invoice_amount,\n          i.invoice_date,\n          i.payment_status,\n          DATEDIFF(CURRENT_DATE, i.invoice_date) as days_outstanding,\n          m.matter_id,\n          m.matter_name,\n          SUM(te.billable_amount) as total_fees,\n          SUM(d.cost_amount) as total_costs,\n          ((SUM(te.billable_amount) - SUM(d.cost_amount)) / SUM(te.billable_amount) * 100) as profit_margin,\n          ta.trust_account_id,\n          ta.current_balance as account_balance,\n          ta.last_reconciliation_date as last_reconciled,\n          ta.reconciliation_status,\n          wip.wip_amount,\n          wip.aging_bucket,\n          mb.budgeted_amount,\n          (SUM(te.billable_amount) + SUM(d.amount)) as actual_amount,\n          (((SUM(te.billable_amount) + SUM(d.amount)) - mb.budgeted_amount) / mb.budgeted_amount * 100) as variance_percentage,\n          CASE \n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) > mb.budgeted_amount THEN 'Over Budget'\n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) < mb.budgeted_amount * 0.9 THEN 'Under Budget'\n            ELSE 'On Budget'\n          END as budget_status,\n          d.disbursement_id,\n          d.disbursement_amount,\n          d.disbursement_type,\n          d.reimbursement_status,\n          pa.practice_area,\n          SUM(pa_rev.revenue_amount) as revenue_amount,\n          AVG(pa_rev.avg_matter_value) as avg_matter_value,\n          pa_rev.growth_rate\n        FROM participants c\n        LEFT JOIN matters m ON c.participant_id = m.client_id\n        LEFT JOIN invoices i ON m.matter_id = i.matter_id\n        LEFT JOIN time_entries te ON m.matter_id = te.matter_id\n        LEFT JOIN disbursements d ON m.matter_id = d.matter_id\n        LEFT JOIN trust_accounts ta ON c.participant_id = ta.client_id\n        LEFT JOIN matter_budgets mb ON m.matter_id = mb.matter_id\n        LEFT JOIN (\n          SELECT matter_id, SUM(billable_amount) as wip_amount,\n                 CASE \n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 30 THEN '0-30 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 60 THEN '31-60 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 90 THEN '61-90 days'\n                   ELSE '90+ days'\n                 END as aging_bucket\n          FROM time_entries \n          WHERE invoice_id IS NULL\n          GROUP BY matter_id\n        ) wip ON m.matter_id = wip.matter_id\n        LEFT JOIN practice_areas pa ON m.practice_area_id = pa.practice_area_id\n        LEFT JOIN practice_area_revenue pa_rev ON pa.practice_area_id = pa_rev.practice_area_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, i.invoice_id, d.disbursement_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "invoice_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "invoice_date",
        "type": "DATE",
        "aggregation": "NONE"
      },
      {
        "name": "payment_status",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "client_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "invoice_amount",
        "type": "NUMBER",
        "aggregation": "SUM"
      },
      {
        "name": "days_outstanding",
        "type": "NUMBER",
        "aggregation": "COUNT"
      }
    ],
    "filters": [
      {
        "field": "payment_status",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Paid"
        ]
      }
    ],
    "visualization": {
      "type": "TABLE",
      "config": {
        "dimensions": [
          "invoice_id",
          "invoice_date",
          "payment_status",
          "client_name"
        ],
        "metrics": [
          "invoice_amount",
          "days_outstanding"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "analyst",
        "admin"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Matter Budget Variance",
    "dataSource": {
      "name": "Matter Budget Variance Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          SUM(CASE WHEN i.payment_status = 'paid' THEN i.total_amount ELSE 0 END) as total_revenue,\n          'current_month' as billing_period,\n          COUNT(DISTINCT m.matter_id) as matter_count,\n          SUM(CASE WHEN i.payment_status != 'paid' THEN i.total_amount ELSE 0 END) as outstanding_balance,\n          i.invoice_id,\n          i.invoice_amount,\n          i.invoice_date,\n          i.payment_status,\n          DATEDIFF(CURRENT_DATE, i.invoice_date) as days_outstanding,\n          m.matter_id,\n          m.matter_name,\n          SUM(te.billable_amount) as total_fees,\n          SUM(d.cost_amount) as total_costs,\n          ((SUM(te.billable_amount) - SUM(d.cost_amount)) / SUM(te.billable_amount) * 100) as profit_margin,\n          ta.trust_account_id,\n          ta.current_balance as account_balance,\n          ta.last_reconciliation_date as last_reconciled,\n          ta.reconciliation_status,\n          wip.wip_amount,\n          wip.aging_bucket,\n          mb.budgeted_amount,\n          (SUM(te.billable_amount) + SUM(d.amount)) as actual_amount,\n          (((SUM(te.billable_amount) + SUM(d.amount)) - mb.budgeted_amount) / mb.budgeted_amount * 100) as variance_percentage,\n          CASE \n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) > mb.budgeted_amount THEN 'Over Budget'\n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) < mb.budgeted_amount * 0.9 THEN 'Under Budget'\n            ELSE 'On Budget'\n          END as budget_status,\n          d.disbursement_id,\n          d.disbursement_amount,\n          d.disbursement_type,\n          d.reimbursement_status,\n          pa.practice_area,\n          SUM(pa_rev.revenue_amount) as revenue_amount,\n          AVG(pa_rev.avg_matter_value) as avg_matter_value,\n          pa_rev.growth_rate\n        FROM participants c\n        LEFT JOIN matters m ON c.participant_id = m.client_id\n        LEFT JOIN invoices i ON m.matter_id = i.matter_id\n        LEFT JOIN time_entries te ON m.matter_id = te.matter_id\n        LEFT JOIN disbursements d ON m.matter_id = d.matter_id\n        LEFT JOIN trust_accounts ta ON c.participant_id = ta.client_id\n        LEFT JOIN matter_budgets mb ON m.matter_id = mb.matter_id\n        LEFT JOIN (\n          SELECT matter_id, SUM(billable_amount) as wip_amount,\n                 CASE \n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 30 THEN '0-30 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 60 THEN '31-60 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 90 THEN '61-90 days'\n                   ELSE '90+ days'\n                 END as aging_bucket\n          FROM time_entries \n          WHERE invoice_id IS NULL\n          GROUP BY matter_id\n        ) wip ON m.matter_id = wip.matter_id\n        LEFT JOIN practice_areas pa ON m.practice_area_id = pa.practice_area_id\n        LEFT JOIN practice_area_revenue pa_rev ON pa.practice_area_id = pa_rev.practice_area_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, i.invoice_id, d.disbursement_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "matter_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "budget_status",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "budgeted_amount",
        "type": "NUMBER",
        "aggregation": "SUM"
      },
      {
        "name": "actual_amount",
        "type": "NUMBER",
        "aggregation": "SUM"
      },
      {
        "name": "variance_percentage",
        "type": "NUMBER",
        "aggregation": "AVG"
      }
    ],
    "filters": [
      {
        "field": "budget_status",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Under Budget"
        ]
      }
    ],
    "visualization": {
      "type": "BAR_CHART",
      "config": {
        "dimensions": [
          "matter_id",
          "budget_status"
        ],
        "metrics": [
          "budgeted_amount",
          "actual_amount",
          "variance_percentage"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "partner",
        "senior_associate"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Matter Profitability Analysis",
    "dataSource": {
      "name": "Matter Profitability Analysis Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          SUM(CASE WHEN i.payment_status = 'paid' THEN i.total_amount ELSE 0 END) as total_revenue,\n          'current_month' as billing_period,\n          COUNT(DISTINCT m.matter_id) as matter_count,\n          SUM(CASE WHEN i.payment_status != 'paid' THEN i.total_amount ELSE 0 END) as outstanding_balance,\n          i.invoice_id,\n          i.invoice_amount,\n          i.invoice_date,\n          i.payment_status,\n          DATEDIFF(CURRENT_DATE, i.invoice_date) as days_outstanding,\n          m.matter_id,\n          m.matter_name,\n          SUM(te.billable_amount) as total_fees,\n          SUM(d.cost_amount) as total_costs,\n          ((SUM(te.billable_amount) - SUM(d.cost_amount)) / SUM(te.billable_amount) * 100) as profit_margin,\n          ta.trust_account_id,\n          ta.current_balance as account_balance,\n          ta.last_reconciliation_date as last_reconciled,\n          ta.reconciliation_status,\n          wip.wip_amount,\n          wip.aging_bucket,\n          mb.budgeted_amount,\n          (SUM(te.billable_amount) + SUM(d.amount)) as actual_amount,\n          (((SUM(te.billable_amount) + SUM(d.amount)) - mb.budgeted_amount) / mb.budgeted_amount * 100) as variance_percentage,\n          CASE \n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) > mb.budgeted_amount THEN 'Over Budget'\n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) < mb.budgeted_amount * 0.9 THEN 'Under Budget'\n            ELSE 'On Budget'\n          END as budget_status,\n          d.disbursement_id,\n          d.disbursement_amount,\n          d.disbursement_type,\n          d.reimbursement_status,\n          pa.practice_area,\n          SUM(pa_rev.revenue_amount) as revenue_amount,\n          AVG(pa_rev.avg_matter_value) as avg_matter_value,\n          pa_rev.growth_rate\n        FROM participants c\n        LEFT JOIN matters m ON c.participant_id = m.client_id\n        LEFT JOIN invoices i ON m.matter_id = i.matter_id\n        LEFT JOIN time_entries te ON m.matter_id = te.matter_id\n        LEFT JOIN disbursements d ON m.matter_id = d.matter_id\n        LEFT JOIN trust_accounts ta ON c.participant_id = ta.client_id\n        LEFT JOIN matter_budgets mb ON m.matter_id = mb.matter_id\n        LEFT JOIN (\n          SELECT matter_id, SUM(billable_amount) as wip_amount,\n                 CASE \n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 30 THEN '0-30 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 60 THEN '31-60 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 90 THEN '61-90 days'\n                   ELSE '90+ days'\n                 END as aging_bucket\n          FROM time_entries \n          WHERE invoice_id IS NULL\n          GROUP BY matter_id\n        ) wip ON m.matter_id = wip.matter_id\n        LEFT JOIN practice_areas pa ON m.practice_area_id = pa.practice_area_id\n        LEFT JOIN practice_area_revenue pa_rev ON pa.practice_area_id = pa_rev.practice_area_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, i.invoice_id, d.disbursement_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "matter_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "matter_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "practice_area",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "total_fees",
        "type": "NUMBER",
        "aggregation": "SUM"
      },
      {
        "name": "total_costs",
        "type": "NUMBER",
        "aggregation": "SUM"
      },
      {
        "name": "profit_margin",
        "type": "NUMBER",
        "aggregation": "AVG"
      }
    ],
    "filters": [
      {
        "field": "practice_area",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Litigation"
        ]
      }
    ],
    "visualization": {
      "type": "TABLE",
      "config": {
        "dimensions": [
          "matter_id",
          "matter_name",
          "practice_area"
        ],
        "metrics": [
          "total_fees",
          "total_costs",
          "profit_margin"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "partner",
        "senior_associate"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Matter Type Distribution",
    "dataSource": {
      "name": "Matter Type Distribution Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          m.matter_number as matter_id,\n          m.matter_name,\n          p.display_name as client_name,\n          m.matter_status,\n          m.date_opened,\n          rp.display_name as responsible_partner,\n          t.due_date as deadline_date,\n          t.task_type as deadline_type,\n          ap.display_name as assigned_fee_earner,\n          t.priority as priority_level,\n          doc.document_count,\n          doc.reviewed_count,\n          dp.production_status,\n          ca.appearance_date as court_date,\n          ca.court_name,\n          ca.hearing_type,\n          ca.attending_participant as attending_counsel,\n          cc.conflict_status,\n          cc.check_date,\n          cc.checked_by_participant as checked_by,\n          m.practice_area\n        FROM matters m\n        LEFT JOIN participants p ON m.client_id = p.participant_id\n        LEFT JOIN participants rp ON m.responsible_partner_id = rp.participant_id\n        LEFT JOIN tasks t ON m.matter_id = t.matter_id\n        LEFT JOIN participants ap ON t.assigned_participant_id = ap.participant_id\n        LEFT JOIN (\n          SELECT matter_id, COUNT(*) as document_count, \n                 SUM(CASE WHEN review_status = 'reviewed' THEN 1 ELSE 0 END) as reviewed_count\n          FROM documents \n          GROUP BY matter_id\n        ) doc ON m.matter_id = doc.matter_id\n        LEFT JOIN document_productions dp ON m.matter_id = dp.matter_id\n        LEFT JOIN court_appearances ca ON m.matter_id = ca.matter_id\n        LEFT JOIN conflict_checks cc ON m.matter_id = cc.matter_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "practice_area",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "matter_count",
        "type": "NUMBER",
        "aggregation": "COUNT"
      },
      {
        "name": "total_revenue",
        "type": "NUMBER",
        "aggregation": "SUM"
      },
      {
        "name": "avg_matter_value",
        "type": "NUMBER",
        "aggregation": "SUM"
      }
    ],
    "filters": [
      {
        "field": "practice_area",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Litigation"
        ]
      }
    ],
    "visualization": {
      "type": "PIE_CHART",
      "config": {
        "dimensions": [
          "practice_area"
        ],
        "metrics": [
          "matter_count",
          "total_revenue",
          "avg_matter_value"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "partner",
        "senior_associate"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Practice Area Revenue",
    "dataSource": {
      "name": "Practice Area Revenue Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          SUM(CASE WHEN i.payment_status = 'paid' THEN i.total_amount ELSE 0 END) as total_revenue,\n          'current_month' as billing_period,\n          COUNT(DISTINCT m.matter_id) as matter_count,\n          SUM(CASE WHEN i.payment_status != 'paid' THEN i.total_amount ELSE 0 END) as outstanding_balance,\n          i.invoice_id,\n          i.invoice_amount,\n          i.invoice_date,\n          i.payment_status,\n          DATEDIFF(CURRENT_DATE, i.invoice_date) as days_outstanding,\n          m.matter_id,\n          m.matter_name,\n          SUM(te.billable_amount) as total_fees,\n          SUM(d.cost_amount) as total_costs,\n          ((SUM(te.billable_amount) - SUM(d.cost_amount)) / SUM(te.billable_amount) * 100) as profit_margin,\n          ta.trust_account_id,\n          ta.current_balance as account_balance,\n          ta.last_reconciliation_date as last_reconciled,\n          ta.reconciliation_status,\n          wip.wip_amount,\n          wip.aging_bucket,\n          mb.budgeted_amount,\n          (SUM(te.billable_amount) + SUM(d.amount)) as actual_amount,\n          (((SUM(te.billable_amount) + SUM(d.amount)) - mb.budgeted_amount) / mb.budgeted_amount * 100) as variance_percentage,\n          CASE \n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) > mb.budgeted_amount THEN 'Over Budget'\n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) < mb.budgeted_amount * 0.9 THEN 'Under Budget'\n            ELSE 'On Budget'\n          END as budget_status,\n          d.disbursement_id,\n          d.disbursement_amount,\n          d.disbursement_type,\n          d.reimbursement_status,\n          pa.practice_area,\n          SUM(pa_rev.revenue_amount) as revenue_amount,\n          AVG(pa_rev.avg_matter_value) as avg_matter_value,\n          pa_rev.growth_rate\n        FROM participants c\n        LEFT JOIN matters m ON c.participant_id = m.client_id\n        LEFT JOIN invoices i ON m.matter_id = i.matter_id\n        LEFT JOIN time_entries te ON m.matter_id = te.matter_id\n        LEFT JOIN disbursements d ON m.matter_id = d.matter_id\n        LEFT JOIN trust_accounts ta ON c.participant_id = ta.client_id\n        LEFT JOIN matter_budgets mb ON m.matter_id = mb.matter_id\n        LEFT JOIN (\n          SELECT matter_id, SUM(billable_amount) as wip_amount,\n                 CASE \n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 30 THEN '0-30 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 60 THEN '31-60 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 90 THEN '61-90 days'\n                   ELSE '90+ days'\n                 END as aging_bucket\n          FROM time_entries \n          WHERE invoice_id IS NULL\n          GROUP BY matter_id\n        ) wip ON m.matter_id = wip.matter_id\n        LEFT JOIN practice_areas pa ON m.practice_area_id = pa.practice_area_id\n        LEFT JOIN practice_area_revenue pa_rev ON pa.practice_area_id = pa_rev.practice_area_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, i.invoice_id, d.disbursement_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "practice_area",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "revenue_amount",
        "type": "NUMBER",
        "aggregation": "SUM"
      },
      {
        "name": "matter_count",
        "type": "NUMBER",
        "aggregation": "COUNT"
      },
      {
        "name": "avg_matter_value",
        "type": "NUMBER",
        "aggregation": "SUM"
      },
      {
        "name": "growth_rate",
        "type": "NUMBER",
        "aggregation": "AVG"
      }
    ],
    "filters": [
      {
        "field": "practice_area",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Litigation"
        ]
      }
    ],
    "visualization": {
      "type": "PIE_CHART",
      "config": {
        "dimensions": [
          "practice_area"
        ],
        "metrics": [
          "revenue_amount",
          "matter_count",
          "avg_matter_value",
          "growth_rate"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "partner",
        "senior_associate"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Staff Utilization Report",
    "dataSource": {
      "name": "Staff Utilization Report Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          p.participant_id as fee_earner_id,\n          p.display_name as fee_earner_name,\n          SUM(te.billable_hours) as billable_hours,\n          SUM(te.non_billable_hours) as non_billable_hours,\n          te.entry_date,\n          p.standard_rate as hourly_rate,\n          (SUM(te.billable_hours) / p.target_hours * 100) as utilization_rate,\n          p.target_hours,\n          (SUM(te.billable_hours) + SUM(te.non_billable_hours)) as actual_hours,\n          p.department,\n          SUM(te.billable_amount) as monthly_billings,\n          (SUM(collected_amount) / SUM(te.billable_amount) * 100) as realization_rate,\n          COUNT(DISTINCT CASE WHEN p.originating_partner_id = p.participant_id THEN c.client_id END) as client_origination\n        FROM participants p\n        LEFT JOIN time_entries te ON p.participant_id = te.fee_earner_id\n        LEFT JOIN matters m ON te.matter_id = m.matter_id\n        LEFT JOIN participants c ON m.client_id = c.participant_id\n        WHERE p.participant_type IN ('partner', 'associate', 'paralegal')\n        GROUP BY p.participant_id, te.entry_date\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "fee_earner_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "fee_earner_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "department",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "utilization_rate",
        "type": "NUMBER",
        "aggregation": "AVG"
      },
      {
        "name": "target_hours",
        "type": "NUMBER",
        "aggregation": "COUNT"
      },
      {
        "name": "actual_hours",
        "type": "NUMBER",
        "aggregation": "COUNT"
      }
    ],
    "filters": [
      {
        "field": "department",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Litigation"
        ]
      }
    ],
    "visualization": {
      "type": "BAR_CHART",
      "config": {
        "dimensions": [
          "fee_earner_id",
          "fee_earner_name",
          "department"
        ],
        "metrics": [
          "utilization_rate",
          "target_hours",
          "actual_hours"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "partner",
        "senior_associate"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Task Completion Metrics",
    "dataSource": {
      "name": "Task Completion Metrics Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          AVG(cs.satisfaction_rating) as satisfaction_score,\n          cs.survey_date,\n          cs.feedback_category,\n          comm.communication_date,\n          comm.communication_type,\n          AVG(DATEDIFF(comm.response_date, comm.inquiry_date) * 24) as response_time_hours,\n          p.display_name as fee_earner_name,\n          tasks.tasks_completed,\n          tasks.tasks_pending,\n          (tasks.tasks_completed / (tasks.tasks_completed + tasks.tasks_pending) * 100) as completion_rate,\n          AVG(DATEDIFF(tasks.completion_date, tasks.assignment_date)) as avg_completion_time\n        FROM participants c\n        LEFT JOIN client_surveys cs ON c.participant_id = cs.client_id\n        LEFT JOIN communications comm ON c.participant_id = comm.client_id\n        LEFT JOIN participants p ON comm.fee_earner_id = p.participant_id\n        LEFT JOIN (\n          SELECT \n            fee_earner_id,\n            SUM(CASE WHEN status = 'completed' THEN 1 ELSE 0 END) as tasks_completed,\n            SUM(CASE WHEN status IN ('pending', 'in_progress') THEN 1 ELSE 0 END) as tasks_pending,\n            completion_date,\n            assignment_date\n          FROM tasks\n          GROUP BY fee_earner_id\n        ) tasks ON p.participant_id = tasks.fee_earner_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, cs.survey_date, comm.communication_date\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "fee_earner_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "tasks_completed",
        "type": "NUMBER",
        "aggregation": "COUNT"
      },
      {
        "name": "tasks_pending",
        "type": "NUMBER",
        "aggregation": "COUNT"
      },
      {
        "name": "completion_rate",
        "type": "NUMBER",
        "aggregation": "AVG"
      },
      {
        "name": "avg_completion_time",
        "type": "NUMBER",
        "aggregation": "COUNT"
      }
    ],
    "filters": [],
    "visualization": {
      "type": "LINE_CHART",
      "config": {
        "dimensions": [
          "fee_earner_id"
        ],
        "metrics": [
          "tasks_completed",
          "tasks_pending",
          "completion_rate",
          "avg_completion_time"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "partner",
        "senior_associate"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Time Entry Dashboard",
    "dataSource": {
      "name": "Time Entry Dashboard Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          p.participant_id as fee_earner_id,\n          p.display_name as fee_earner_name,\n          SUM(te.billable_hours) as billable_hours,\n          SUM(te.non_billable_hours) as non_billable_hours,\n          te.entry_date,\n          p.standard_rate as hourly_rate,\n          (SUM(te.billable_hours) / p.target_hours * 100) as utilization_rate,\n          p.target_hours,\n          (SUM(te.billable_hours) + SUM(te.non_billable_hours)) as actual_hours,\n          p.department,\n          SUM(te.billable_amount) as monthly_billings,\n          (SUM(collected_amount) / SUM(te.billable_amount) * 100) as realization_rate,\n          COUNT(DISTINCT CASE WHEN p.originating_partner_id = p.participant_id THEN c.client_id END) as client_origination\n        FROM participants p\n        LEFT JOIN time_entries te ON p.participant_id = te.fee_earner_id\n        LEFT JOIN matters m ON te.matter_id = m.matter_id\n        LEFT JOIN participants c ON m.client_id = c.participant_id\n        WHERE p.participant_type IN ('partner', 'associate', 'paralegal')\n        GROUP BY p.participant_id, te.entry_date\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "fee_earner_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "fee_earner_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "entry_date",
        "type": "DATE",
        "aggregation": "NONE"
      },
      {
        "name": "billable_hours",
        "type": "NUMBER",
        "aggregation": "COUNT"
      },
      {
        "name": "non_billable_hours",
        "type": "NUMBER",
        "aggregation": "COUNT"
      },
      {
        "name": "hourly_rate",
        "type": "NUMBER",
        "aggregation": "SUM"
      }
    ],
    "filters": [
      {
        "field": "entry_date",
        "type": "DATE_RANGE",
        "defaultValue": "last_30_days",
        "allowMultiple": false,
        "options": [
          "\"today"
        ]
      }
    ],
    "visualization": {
      "type": "LINE_CHART",
      "config": {
        "dimensions": [
          "fee_earner_id",
          "fee_earner_name",
          "entry_date"
        ],
        "metrics": [
          "billable_hours",
          "non_billable_hours",
          "hourly_rate"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "analyst",
        "admin"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "Trust Account Reconciliation",
    "dataSource": {
      "name": "Trust Account Reconciliation Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          SUM(CASE WHEN i.payment_status = 'paid' THEN i.total_amount ELSE 0 END) as total_revenue,\n          'current_month' as billing_period,\n          COUNT(DISTINCT m.matter_id) as matter_count,\n          SUM(CASE WHEN i.payment_status != 'paid' THEN i.total_amount ELSE 0 END) as outstanding_balance,\n          i.invoice_id,\n          i.invoice_amount,\n          i.invoice_date,\n          i.payment_status,\n          DATEDIFF(CURRENT_DATE, i.invoice_date) as days_outstanding,\n          m.matter_id,\n          m.matter_name,\n          SUM(te.billable_amount) as total_fees,\n          SUM(d.cost_amount) as total_costs,\n          ((SUM(te.billable_amount) - SUM(d.cost_amount)) / SUM(te.billable_amount) * 100) as profit_margin,\n          ta.trust_account_id,\n          ta.current_balance as account_balance,\n          ta.last_reconciliation_date as last_reconciled,\n          ta.reconciliation_status,\n          wip.wip_amount,\n          wip.aging_bucket,\n          mb.budgeted_amount,\n          (SUM(te.billable_amount) + SUM(d.amount)) as actual_amount,\n          (((SUM(te.billable_amount) + SUM(d.amount)) - mb.budgeted_amount) / mb.budgeted_amount * 100) as variance_percentage,\n          CASE \n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) > mb.budgeted_amount THEN 'Over Budget'\n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) < mb.budgeted_amount * 0.9 THEN 'Under Budget'\n            ELSE 'On Budget'\n          END as budget_status,\n          d.disbursement_id,\n          d.disbursement_amount,\n          d.disbursement_type,\n          d.reimbursement_status,\n          pa.practice_area,\n          SUM(pa_rev.revenue_amount) as revenue_amount,\n          AVG(pa_rev.avg_matter_value) as avg_matter_value,\n          pa_rev.growth_rate\n        FROM participants c\n        LEFT JOIN matters m ON c.participant_id = m.client_id\n        LEFT JOIN invoices i ON m.matter_id = i.matter_id\n        LEFT JOIN time_entries te ON m.matter_id = te.matter_id\n        LEFT JOIN disbursements d ON m.matter_id = d.matter_id\n        LEFT JOIN trust_accounts ta ON c.participant_id = ta.client_id\n        LEFT JOIN matter_budgets mb ON m.matter_id = mb.matter_id\n        LEFT JOIN (\n          SELECT matter_id, SUM(billable_amount) as wip_amount,\n                 CASE \n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 30 THEN '0-30 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 60 THEN '31-60 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 90 THEN '61-90 days'\n                   ELSE '90+ days'\n                 END as aging_bucket\n          FROM time_entries \n          WHERE invoice_id IS NULL\n          GROUP BY matter_id\n        ) wip ON m.matter_id = wip.matter_id\n        LEFT JOIN practice_areas pa ON m.practice_area_id = pa.practice_area_id\n        LEFT JOIN practice_area_revenue pa_rev ON pa.practice_area_id = pa_rev.practice_area_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, i.invoice_id, d.disbursement_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "trust_account_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "last_reconciled",
        "type": "DATE",
        "aggregation": "NONE"
      },
      {
        "name": "reconciliation_status",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "client_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "account_balance",
        "type": "NUMBER",
        "aggregation": "SUM"
      }
    ],
    "filters": [
      {
        "field": "reconciliation_status",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"Reconciled"
        ]
      }
    ],
    "visualization": {
      "type": "SCORECARD",
      "config": {
        "dimensions": [
          "trust_account_id",
          "last_reconciled",
          "reconciliation_status",
          "client_name"
        ],
        "metrics": [
          "account_balance"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "analyst",
        "admin"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  },
  {
    "name": "WIP Aging Report",
    "dataSource": {
      "name": "WIP Aging Report Data Source",
      "type": "BIGQUERY",
      "config": {
        "query": "\n        SELECT \n          c.participant_id as client_id,\n          c.display_name as client_name,\n          SUM(CASE WHEN i.payment_status = 'paid' THEN i.total_amount ELSE 0 END) as total_revenue,\n          'current_month' as billing_period,\n          COUNT(DISTINCT m.matter_id) as matter_count,\n          SUM(CASE WHEN i.payment_status != 'paid' THEN i.total_amount ELSE 0 END) as outstanding_balance,\n          i.invoice_id,\n          i.invoice_amount,\n          i.invoice_date,\n          i.payment_status,\n          DATEDIFF(CURRENT_DATE, i.invoice_date) as days_outstanding,\n          m.matter_id,\n          m.matter_name,\n          SUM(te.billable_amount) as total_fees,\n          SUM(d.cost_amount) as total_costs,\n          ((SUM(te.billable_amount) - SUM(d.cost_amount)) / SUM(te.billable_amount) * 100) as profit_margin,\n          ta.trust_account_id,\n          ta.current_balance as account_balance,\n          ta.last_reconciliation_date as last_reconciled,\n          ta.reconciliation_status,\n          wip.wip_amount,\n          wip.aging_bucket,\n          mb.budgeted_amount,\n          (SUM(te.billable_amount) + SUM(d.amount)) as actual_amount,\n          (((SUM(te.billable_amount) + SUM(d.amount)) - mb.budgeted_amount) / mb.budgeted_amount * 100) as variance_percentage,\n          CASE \n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) > mb.budgeted_amount THEN 'Over Budget'\n            WHEN (SUM(te.billable_amount) + SUM(d.amount)) < mb.budgeted_amount * 0.9 THEN 'Under Budget'\n            ELSE 'On Budget'\n          END as budget_status,\n          d.disbursement_id,\n          d.disbursement_amount,\n          d.disbursement_type,\n          d.reimbursement_status,\n          pa.practice_area,\n          SUM(pa_rev.revenue_amount) as revenue_amount,\n          AVG(pa_rev.avg_matter_value) as avg_matter_value,\n          pa_rev.growth_rate\n        FROM participants c\n        LEFT JOIN matters m ON c.participant_id = m.client_id\n        LEFT JOIN invoices i ON m.matter_id = i.matter_id\n        LEFT JOIN time_entries te ON m.matter_id = te.matter_id\n        LEFT JOIN disbursements d ON m.matter_id = d.matter_id\n        LEFT JOIN trust_accounts ta ON c.participant_id = ta.client_id\n        LEFT JOIN matter_budgets mb ON m.matter_id = mb.matter_id\n        LEFT JOIN (\n          SELECT matter_id, SUM(billable_amount) as wip_amount,\n                 CASE \n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 30 THEN '0-30 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 60 THEN '31-60 days'\n                   WHEN DATEDIFF(CURRENT_DATE, entry_date) <= 90 THEN '61-90 days'\n                   ELSE '90+ days'\n                 END as aging_bucket\n          FROM time_entries \n          WHERE invoice_id IS NULL\n          GROUP BY matter_id\n        ) wip ON m.matter_id = wip.matter_id\n        LEFT JOIN practice_areas pa ON m.practice_area_id = pa.practice_area_id\n        LEFT JOIN practice_area_revenue pa_rev ON pa.practice_area_id = pa_rev.practice_area_id\n        WHERE c.participant_type = 'client'\n        GROUP BY c.participant_id, i.invoice_id, d.disbursement_id\n      ",
        "dataset": "actionstep_analytics",
        "project": "law-firm-analytics"
      }
    },
    "fields": [
      {
        "name": "matter_id",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "aging_bucket",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "matter_name",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "responsible_partner",
        "type": "TEXT",
        "aggregation": "NONE"
      },
      {
        "name": "wip_amount",
        "type": "NUMBER",
        "aggregation": "SUM"
      }
    ],
    "filters": [
      {
        "field": "aging_bucket",
        "type": "DROPDOWN",
        "allowMultiple": true,
        "options": [
          "\"0-30 days"
        ]
      }
    ],
    "visualization": {
      "type": "BAR_CHART",
      "config": {
        "dimensions": [
          "matter_id",
          "aging_bucket",
          "matter_name",
          "responsible_partner"
        ],
        "metrics": [
          "wip_amount"
        ],
        "colorScheme": "blue_actionstep_theme",
        "showDataLabels": true
      }
    },
    "permissions": {
      "viewRoles": [
        "analyst",
        "admin"
      ],
      "editRoles": [
        "admin",
        "partner"
      ]
    },
    "embedConfig": {
      "allowExternalEmbed": false,
      "domains": []
    }
  }
]